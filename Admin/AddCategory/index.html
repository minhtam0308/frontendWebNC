
  <style>
   body {
      font-family: 'Inter', sans-serif;
    }
   .table-img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 0.375rem;
    }
    td{
      padding: 5px 5px 0 5px;
    }
  </style>
 </head>
 <body class="bg-light d-flex flex-column min-vh-100">
  <header class="bg-white shadow-sm mb-4">
   
  </header>
  <main class="container flex-grow-1">
   <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-4">
    <h2 class="fw-bold mb-3 mb-md-0">
     Quản lý danh mục
    </h2>
    <button class="btn btn-primary d-flex align-items-center" data-bs-target="#categoryModal" data-bs-toggle="modal" id="openAddModalBtn" type="button">
     <i class="fas fa-plus me-2">
     </i>
     Thêm danh mục
    </button>
   </div>
   <div class="table-responsive shadow-sm rounded bg-white">
    <table class="table table-hover align-middle mb-1">
     <thead class="table-light">
      <tr>
       <th scope="col">
        Ảnh minh họa
       </th>
       <th scope="col">
        Tên danh mục
       </th>
       <th scope="col">
        Mô tả
       </th>
       <th class="text-end" scope="col">
        Tính năng
       </th>
      </tr>
     </thead>
     <tbody id="categoryTableBody">
      <tr>
       <td>
        <img alt="Category image showing Fiction books with colorful covers stacked on a wooden table" class="table-img" height="80" src="https://storage.googleapis.com/a1aa/image/fa3250b5-1ff1-44b0-2568-13197a8f20fd.jpg" width="80"/>
       </td>
       <td class="fw-semibold fs-5">
        Fiction
       </td>
       <td class="text-truncate" style="max-width: 300px;">
        Books that contain fictional stories, novels, and narratives.
       </td>
       <td class="text-end">
        <button aria-label="Edit Fiction category" class="btn btn-link text-primary editBtn p-0 me-2" data-id="1" type="button">
         <i class="fas fa-edit fa-lg">
         </i>
        </button>
        <button aria-label="Delete Fiction category" class="btn btn-link text-danger deleteBtn p-0" data-id="1" type="button">
         <i class="fas fa-trash-alt fa-lg">
         </i>
        </button>
       </td>
      </tr>
      <tr>
       <td>
        <img alt="Category image showing Science books with formulas and diagrams on the cover" class="table-img" height="80" src="https://storage.googleapis.com/a1aa/image/f58d6faa-6d42-4395-cf87-81ff53f29a85.jpg" width="80"/>
       </td>
       <td class="fw-semibold fs-5">
        Science
       </td>
       <td class="text-truncate" style="max-width: 300px;">
        Books covering scientific topics, research, and discoveries.
       </td>
       <td class="text-end">
        <button aria-label="Edit Science category" class="btn btn-link text-primary editBtn p-0 me-2" data-id="2" type="button">
         <i class="fas fa-edit fa-lg">
         </i>
        </button>
        <button aria-label="Delete Science category" class="btn btn-link text-danger deleteBtn p-0" data-id="2" type="button">
         <i class="fas fa-trash-alt fa-lg">
         </i>
        </button>
       </td>
      </tr>
      <tr>
       <td>
        <img alt="Category image showing History books stacked with a vintage clock" class="table-img" height="80" src="https://storage.googleapis.com/a1aa/image/0c83b7b2-d09d-4930-9efa-cd126d764d9c.jpg" width="80"/>
       </td>
       <td class="fw-semibold fs-5">
        History
       </td>
       <td class="text-truncate" style="max-width: 300px;">
        Books that explore historical events, biographies, and timelines.
       </td>
       <td class="text-end">
        <button aria-label="Edit History category" class="btn btn-link text-primary editBtn p-0 me-2" data-id="3" type="button">
         <i class="fas fa-edit fa-lg">
         </i>
        </button>
        <button aria-label="Delete History category" class="btn btn-link text-danger deleteBtn p-0" data-id="3" type="button">
         <i class="fas fa-trash-alt fa-lg">
         </i>
        </button>
       </td>
      </tr>
      <tr>
       <td>
        <img alt="Category image showing colorful children's books with cartoon characters on the cover" class="table-img" height="80" src="https://storage.googleapis.com/a1aa/image/576c2bf5-4abd-4c37-e2e4-15cd597a6363.jpg" width="80"/>
       </td>
       <td class="fw-semibold fs-5">
        Children
       </td>
       <td class="text-truncate" style="max-width: 300px;">
        Books designed for children including stories, learning, and fun activities.
       </td>
       <td class="text-end">
        <button aria-label="Edit Children category" class="btn btn-link text-primary editBtn p-0 me-2" data-id="4" type="button">
         <i class="fas fa-edit fa-lg">
         </i>
        </button>
        <button aria-label="Delete Children category" class="btn btn-link text-danger deleteBtn p-0" data-id="4" type="button">
         <i class="fas fa-trash-alt fa-lg">
         </i>
        </button>
       </td>
      </tr>
      <tr>
       <td>
        <img alt="Category image showing biography books with portraits of famous people on the covers" class="table-img" height="80" src="https://storage.googleapis.com/a1aa/image/d172ec11-c49f-4b14-85aa-3d7b1a09e3f6.jpg" width="80"/>
       </td>
       <td class="fw-semibold fs-5">
        Biography
       </td>
       <td class="text-truncate" style="max-width: 300px;">
        Books telling the life stories of notable individuals and personalities.
       </td>
       <td class="text-end">
        <button aria-label="Edit Biography category" class="btn btn-link text-primary editBtn p-0 me-2" data-id="5" type="button">
         <i class="fas fa-edit fa-lg">
         </i>
        </button>
        <button aria-label="Delete Biography category" class="btn btn-link text-danger deleteBtn p-0" data-id="5" type="button">
         <i class="fas fa-trash-alt fa-lg">
         </i>
        </button>
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </main>
  <!-- Modal -->
  <div aria-hidden="true" aria-labelledby="categoryModalLabel" class="modal fade" id="categoryModal" tabindex="-1">
   <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
     <form id="categoryForm" novalidate="">
      <div class="modal-header">
       <h5 class="modal-title fw-bold" id="categoryModalLabel">
        Thêm mới danh mục
       </h5>
       <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button">
       </button>
      </div>
      <div class="modal-body">
       <div class="mb-3">
        <label class="form-label" for="categoryName">
         Tên danh mục
        </label>
        <input class="form-control" id="categoryName" name="categoryName" placeholder="Enter category name" required="" type="text"/>
        <div class="invalid-feedback">
         Nhập tên danh mục.
        </div>
       </div>
       <div class="mb-3">
        <label class="form-label" for="categoryImage">
         Đường dẫn đến ảnh
        </label>
        <input class="form-control" id="categoryImage" name="categoryImage" required="" type="text"/>
        <div class="invalid-feedback">
         Nhập link ảnh đến thư mục.
        </div>
       </div>
       <div class="mb-3">
        <label class="form-label" for="categoryDescription">
         Mô tả
        </label>
        <textarea class="form-control" id="categoryDescription" name="categoryDescription" placeholder="Enter category description" required="" rows="3"></textarea>
        <div class="invalid-feedback">
         Nhập mô tả của danh mục.
        </div>
       </div>
      </div>
      <div class="modal-footer">
       <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">
        Hủy
       </button>
       <button class="btn btn-primary" type="submit">
        Lưu
       </button>
      </div>
     </form>
    </div>
   </div>
  </div>
  <script src="/bootstrap.bundle.min.js">
  </script>
  <script>
   (() => {
      const categoryModalEl = document.getElementById('categoryModal');
      const categoryModal = new bootstrap.Modal(categoryModalEl);
      const categoryForm = document.getElementById('categoryForm');
      const categoryTableBody = document.getElementById('categoryTableBody');
      const modalTitle = categoryModalEl.querySelector('.modal-title');

      let categories = [
        {
          id: 1,
          name: 'Văn Học',
          image: "/Img/danhmuc1.webp",
          description: 'Sách thuộc thể loại văn học, bao gồm các tác phẩm tiểu thuyết, truyện ngắn, thơ ca và kịch bản.',
        },
        {
          id: 2,
          name: 'Tâm Lý Kỹ Năng',
          image:"/Img/danhmuc2.webp",
          description: 'Sách cung cấp kiến thức và hướng dẫn về tâm lý con người, phát triển bản thân và các kỹ năng sống.',
        },
        {
          id: 3,
          name: 'Thiếu Nhi',
          image:"/Img/danhmuc3.webp",
          description: 'Sách dành cho trẻ em, bao gồm truyện cổ tích, truyện tranh, sách giáo dục và giải trí phù hợp lứa tuổi.',
        },
        {
          id: 4,
          name: 'Ngoại Ngữ',
          image:"/Img/danhmuc4.webp",
          description: 'Sách dùng để học và rèn luyện các ngôn ngữ khác ngoài tiếng Việt, như sách giáo trình, từ điển, truyện song ngữ.',
        },
        {
          id: 5,
          name: 'Ngoại Văn',
          image:"/Img/danhmuc6.webp",
          description: 'Sách văn học hoặc các tác phẩm khác được viết bằng ngôn ngữ nước ngoài, chưa được dịch sang tiếng Việt.',
        },
      ];

      let editCategoryId = null;

      function renderCategories() {
        categoryTableBody.innerHTML = '';
        categories.forEach((category) => {
          const tr = document.createElement('tr');

          tr.innerHTML = `
            <td>
              <img src="${category.image}" alt="Category image showing ${category.name} books" class="table-img" />
            </td>
            <td class="fw-semibold fs-5">${category.name}</td>
            <td class="text-truncate" style="max-width: 300px;">${category.description}</td>
            <td class="text-end">
              <button type="button" class="btn btn-link text-primary editBtn p-0 me-2" data-id="${category.id}" aria-label="Edit ${category.name} category">
                <i class="fas fa-edit fa-lg"></i>
              </button>
              <button type="button" class="btn btn-link text-danger deleteBtn p-0" data-id="${category.id}" aria-label="Delete ${category.name} category">
                <i class="fas fa-trash-alt fa-lg"></i>
              </button>
            </td>
          `;

          categoryTableBody.appendChild(tr);
        });

        // Attach event listeners for edit and delete buttons
        document.querySelectorAll('.editBtn').forEach((btn) => {
          btn.addEventListener('click', (e) => {
            const id = parseInt(e.currentTarget.getAttribute('data-id'), 10);
            openModal(id);
          });
        });

        document.querySelectorAll('.deleteBtn').forEach((btn) => {
          btn.addEventListener('click', (e) => {
            const id = parseInt(e.currentTarget.getAttribute('data-id'), 10);
            if (confirm('Are you sure you want to delete this category?')) {
              categories = categories.filter((c) => c.id !== id);
              renderCategories();
            }
          });
        });
      }

      function openModal(editId = null) {
        editCategoryId = editId;
        if (editId !== null) {
          const category = categories.find((c) => c.id === editId);
          if (category) {
            categoryForm.categoryName.value = category.name;
            categoryForm.categoryImage.value = category.image;
            categoryForm.categoryDescription.value = category.description;
            modalTitle.textContent = 'Sửa danh mục';
          }
        } else {
          categoryForm.reset();
          modalTitle.textContent = 'Thêm mới danh mục';
        }
        categoryForm.classList.remove('was-validated');
        categoryModal.show();
      }

      categoryForm.addEventListener('submit', (e) => {
        e.preventDefault();
        e.stopPropagation();

        if (!categoryForm.checkValidity()) {
          categoryForm.classList.add('was-validated');
          return;
        }

        const name = categoryForm.categoryName.value.trim();
        const image = categoryForm.categoryImage.value.trim();
        const description = categoryForm.categoryDescription.value.trim();

        if (editCategoryId !== null) {
          // Edit existing
          const index = categories.findIndex((c) => c.id === editCategoryId);
          if (index !== -1) {
            categories[index] = {
              id: editCategoryId,
              name,
              image,
              description,
            };
          }
        } else {
          // Add new
          const newId = categories.length ? Math.max(...categories.map((c) => c.id)) + 1 : 1;
          categories.push({
            id: newId,
            name,
            image,
            description,
          });
        }

        renderCategories();
        categoryModal.hide();
      });

      // Open modal for adding new category
      document.getElementById('openAddModalBtn').addEventListener('click', () => openModal());

      // Initial render
      renderCategories();
    })();
  </script>
 </body>
</html>
